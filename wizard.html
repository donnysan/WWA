<!doctype html>
 
<html>
<head>
	<meta charset="utf-8">     
	<title>Settings</title>

	<link rel="stylesheet" href="./css/jquery.mobile-1.3.2.min.css" type="text/css">
	<link rel="stylesheet" href="./Plugins/Zebra-Datepicker/examples/public/css/style.css" type="text/css">
	<link rel="stylesheet" href="./Plugins/Zebra-Datepicker/public/css/default.css" type="text/css"> 
	<link rel="stylesheet" href="./Plugins/Zebra_Dialog-1.3.8/public/css/default/zebra_dialog.css" type="text/css" />
	<link rel="stylesheet" href="./css/wizard.css" type="text/css" />	
	<link rel="stylesheet" href="./Plugins/jQuery Keypad 2.0.0/jquery.keypad.css" type="text/css">	
	<link rel="stylesheet" href="./Plugins/Touch Friendly Input Spinner/bootstrap/css/bootstrap.css" type="text/css">
	<link rel="stylesheet" href="./Plugins/JQuerySpinnerControl_1.0.2/Styles/jquery.spinnercontrol.css" type="text/css" />
	<link rel="stylesheet" type="text/css" href="./Plugins/Android-Style-Date-Picker-For-jQuery-Mobile-Mobi-Pick/css/mobipick.css" />
</head>
<body>
	<!-- Wizard Control -->
	<div data-role="page" id="wizard-page">
		<div data-role="header" data-theme="b">
			<h1 id="wizard-header" ></h1>
			<a href="index.html" id="wizard-back-button" data-icon="home" data-iconpos="right" data-inline="true" data-role="button" class="ui-btn-left">Home</a> 
		</div>
		
		<!-- Unit settings -->
		<div data-role="content" id="page1-unit-settings">	
			<div>                  
				<table cellpadding="0" cellspacing="0">					
					<col style="width:44px;" />					
					<col style="width:auto;" />					
					<tr>												
						<td>							
							<div>																 
								<a href="javascript:void(0)" id="units-help"><img class="info_image" src="./img/information.jpg" /></a>							
							</div>                          
						</td>                                                     
						<td>                                                                                 
							<div class="mobile_label">                                       
								Unit System                                   
							</div>                                                                  
							<div data-role="fieldcontain">                                     
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="false">                                           
									<option value="0" selected="selected">- Select -</option>                                          
									<option value="1">Standard (U.S.)</option>                                          
									<option value="2">Metric</option>                                       
								</select>											
							</div>																	   
						</td>									
					</tr>   
					<tr>
						<td>
						    <div>																		 
								<a href="javascript:void(0)" id="points-system-help"><img class="info_image" src="./img/information.jpg" /> </a>                                
						    </div>	 
						</td>
						<td>
							<div class="mobile_label">										
								Points System                                    
							</div>
			 				<div data-role="fieldcontain">
							    <select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="false">												
									<option value="0" selected="selected">- Select -</option>													
									<option value="1">Plus System</option>													
									<option value="2">Classic System</option>												
								</select>										
							</div>		  
						</td>
					</tr>    
					<tr>
						<td>
							<div>																		 
								<a href="javascript:void(0)" id="points-precision-help"><img class="info_image" src="./img/information.jpg"	/> </a>                                
							</div>		 
						</td>
						<td>
							<div class="mobile_label">Points Precision</div>		 
							<div data-role="fieldcontain">												
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="false">													
									<option value="0" selected="selected">- Select -</option>													
									<option value="1">Whole Point</option>											
									<option value="2">Half Point (0.5)</option>
									<option value="3">Tenth Point (0.1)</option>											 
								</select>											
						        </div>		  
						</td>
					</tr>                              
				</table>               
			</div>
			<br>
			<hr>

			<div data-role="controlgroup" data-type="horizontal" id="page1-unit-settings-buttons">
				<a href="#" data-role="button" data-theme="e" class="next" style="width: 100px; margin:0 10px 0px 0px;">Next</a>
			</div>           
		</div>
     
		<!-- Weight Settings -->
		<div data-role="content" id="page2-weight-settings">
			<div data-role="fieldcontain" data-controltype="textinput">            
				<label for="current-weight">Enter your current weight (lb/kg):</label>     
				<div style="width: 75px">     
					<input type="text" id="current-weight" max="999">  
				</div>     
    			</div>         
   		    	<div data-role="fieldcontain" data-controltype="textinput">             
				<label for="goal-weight">Enter your weight goal (lb/kg):</label>
				<div style="width: 75px">             
					<input type="text" name="goal-weight" id="goal-weight" max="999">
				</div>      
			</div>  
       
			<div>                  
				<table cellpadding="0" cellspacing="0">										
					<col style="width:auto;" />					
					<tr>												                                                   
						<td>                                                                                 
							<div class="mobile_label">                                       
								Enter your goal date (old DatePicker)                                   
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<input id="test-datepicker" type="text">                                 
							</div>  																   
						</td>	
					</tr>
					<tr>												                                                   
						<td>                                                                                 
							<div class="mobile_label">                                       
								Enter your goal date (new DatePicker)                                   
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<input type="text" id="txtDP" />                                 
							</div>  																   
						</td>	
					</tr>								                            
				</table>               
			</div>

	        <div data-role="controlgroup" data-type="horizontal" id="page2-weight-settings-buttons">
		    <a href="#" data-role="button" data-theme="b" class="prev" style="width: 125px; margin:0 10px 0px 0px;">Previous</a>
		    <a href="#" data-role="button" data-theme="e" class="next" style="width: 100px; margin:0 10px 0px 0px;">Next</a>
	        </div>
        </div>
 
	    <!-- Points Allowance Settings -->
        <div data-role="content" id="page3-points-allowance-settings">	
			<div>                  
				<table cellpadding="0" cellspacing="0">					
					<col style="width:44px;" />					
					<col style="width:auto;" />					
					<tr>												
						<td>							
							<div>																 
								<a href="javascript:void(0)" id="daily-points-allowance-help"><img class="info_image" src="./img/information.jpg" /></a>							
							</div>                          
						</td>                                                     
						<td>                                                                                 
							<div class="mobile_label_2_line">                                       
								How do you want to determine your Daily Point Allowance?                                    
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="selDPA" data-native-menu="false">                                          
									<option value="0" selected="selected"> - Select - </option>                                          
									<option value="1"> Used a fixed value </option>                                          
									<option value="2">Calculate the Value (Plus System)</option>       
									<option value="3">Calculate the Value (Classic System)</option>    
								</select>                                  
							</div>  																   
						</td>	
					</tr>								                            
				</table>               
			</div>
	
	        	<div id="dpa-fixed" style="display: none;">                
				<table cellpadding="0" cellspacing="0">                      
					<col style="width:100px;" />  
					<tr>                                                                                                                             
						<td>    
							<label for="txtUserSpecifiedDPA">Enter a Value</label>                                                                     
							<input type="text" id="txtUserSpecifiedDPA" />                      
						</td>
					</tr>
				</table>  
			</div>
		
			<div id="dpa-calculated" style="display: none;"> 
				<h2 id="dpa-result" style="color: red">Your DPA...</h2>                               
			</div>
	       
			<div id="plus-pa-settings" style="display: none;">
				<hr style="height:1px; background-color:#ccc; border:0; margin-top:12px; margin-bottom:12px;"/>         
				<div data-controltype="textblock">
					<h3><b>Enter Calculation Values  - Plus System</b></h3>
				</div>

				<!-- Old spinner -->
				<h4> This is the spinner that was 'double bumping' on the phone</h4>

	        		<div>                
					<table cellpadding="0" cellspacing="0">                      
						<col style="width:300px;" />  
						<tr>                                                                                                                            
							<td>    
								<div class="mobile_label">                                       
									Your height (ft / m)                                    
								</div>   
                  						<input id="user-height-feet" type="text" value="" name="user-height-feet">
							</td>
						</tr>
						<tr>
							<td>    
								<div class="mobile_label">                                       
									Your height (in / m)                                    
								</div>   
                  						<input id="user-height-inches" type="text" value="" name="user-height-inches">
							</td>
						</tr>
					</table>  
				</div>

				<div>                  
					<table cellpadding="0" cellspacing="0">										
						<col style="width: 200px;" />					
						<tr>												                                                   
							<td>                                                                                 
								<div class="mobile_label">                                       
									Your Gender                                    
								</div>                                                                  
								<div data-role="fieldcontain">                                       
									<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-gender-plus" data-native-menu="false">                                          
										<option value="0" selected="selected"> - Select - </option>  
										<option value="1">Male</option>             
										<option value="2">Female</option>  
									</select>                                  
								</div>  																   
							</td>	
						</tr>	
						<tr>												                                                   
							<td>           
								<div id="div-breastfeeding-mom-plus" style="display: none;">                                                                      
									<div class="mobile_label">                                       
										Are you Breastfeeding?                                    
									</div>                                                                  
									<div data-role="fieldcontain">                                       
										<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-breastfeeding-plus" data-native-menu="false">                                          
											<option value="0" selected="selected"> - Select - </option>  
											<option value="1">Not Breastfeeding</option>                 
											<option value="2">Supplementally Breastfeeding</option>                
											<option value="3">Exclusively Breastfeeding</option>     
										</select>                                  
									</div>  
								</div> 																   
							</td>	
						</tr>					                            
					</table>               
				</div>    
 
				<div>                  
					<table cellpadding="0" cellspacing="0">										
						<col style="width:75px;" />					
						<tr>												                                                   
							<td>                                                                                 
								<div class="mobile_label">                                       
									Your Age                                    
								</div>                                                                  
								<div data-role="fieldcontain">                                       
									<input id="txt-plus-age" type="text" max="999"/>                                 
								</div>  																   
							</td>	
						</tr>	
						<tr>												                                                   
							<td>           
								<div data-role="fieldcontain">                                                                      
									<div class="mobile_label">                                       
										Your Weight (lb)                                   
									</div>                                                                                                      
									<input id="txt-plus-weight" type="text" max="999"/>                                 
								</div> 																   
							</td>	
						</tr>					                            
					</table>               
				</div>  
				
				<!-- New spinner -->
				<div class="mobile_label">Enter Your Height</div> 
				<div>                  
					<table cellpadding="0" cellspacing="0">									
						<col style="width:200px;" />					
						<tr>												                                                   
							<td>                                                                                 
								<div class="mobile_label">                                       
									Feet                                    
								</div>                                                                  
								<input type="text" id="txt-height-ft" />																   
							</td>	
						</tr>	
						<tr>												                                                   
							<td>                                                                                 
								<div class="mobile_label">                                       
									Inches                                    
								</div>                                                                  
								<input type="text" id="txt-height-in"/> 																   
							</td>	
						</tr>					                            
					</table>               
				</div>
				<div id="btn-calculate-dpa-plus" data-role="button">Calculate Plus DPA</div>
            		</div> 
 
			<div id="classic-pa-settings" style="display: none;">   
    		    	        <div data-controltype="textblock">             
			    		<h3><b>Enter Calculation Values - Classic System</b></h3>         
    		    		</div>     

		    	<div>                  
		    	    <table cellpadding="0" cellspacing="0">									
				    <col style="width:auto;" />					
				    <tr>												                                                    
					    <td>                                                                                 
						    <div class="mobile_label">                                       
							    Your Gender                                    
						    </div>                                                                  
						    <div data-role="fieldcontain">                                       
							    <select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-gender-classic" data-native-menu="false">                                          
								    <option value="0" selected="selected"> - Select - </option>  
								    <option value="1">Male</option>             
								    <option value="2">Female</option>  
							    </select>                                  
						    </div>  																   
					    </td>	
				    </tr>					                            
			    </table>               
		    	</div> 
			
		    <div data-role="fieldcontain" id="div-breastfeeding-mom-classic" data-controltype="selectmenu" style="display: none;">             
   		            <input type="checkbox" name="classic-breastfeeding" value="0" id="ckBreastfeeding">          
    			    <label for="ckBreastfeeding">Breastfeeding Mom</label>        
		    </div>   

		    <div>                  
			    <table cellpadding="0" cellspacing="0">										
				    <col style="width:100px;" />					
				    <tr>												                                                   
					    <td>                                                                                 
						    <div class="mobile_label">Your Age</div>                                                                  
						    <select id="select-age-classic" name="">               
						            <option value="0"> - Select - </option>  
							    <option value="1">17 - 26</option>             
							    <option value="2">27 - 37</option>   
							    <option value="3">38 - 47</option>             
							    <option value="4">48 - 58</option>  
							    <option value="5">Over 58</option>                            
						    </select>   																   
					    </td>	
				    </tr>	
				    <tr>												                                                   
					    <td>           
					             <div data-role="fieldcontain">                                                                      
					             <div class="mobile_label">Your Weight (lb)</div>                                                                                                      
						             <input id="txt-classic-weight" type="text" max="999"/>                                  
						     </div> 																   
					    </td>	
				    </tr>					                            
			    </table>               
		    </div>  
				
    		    <div data-role="fieldcontain" data-controltype="selectmenu">             
					<label for="select-height-classic">Your height</label>             
					<select id="select-height-classic">                  
						<option value="0">- Select -</option>                
						<option value="1">Under 5'1&#34; / 1.55m</option>                
						<option value="2">5'1&#34; to 5&#34;10&#34; / 1.55m to 1.78m</option>                 
						<option value="3">Over 5'10&#34; / 1.78m</option>              
					</select>       
    		    </div>         
    		    <div data-role="fieldcontain" data-controltype="selectmenu">            
					<label for="select-activity-level-classic">Your Daily Routine</label>             
					<select id="select-activity-level-classic" name="">                 
						<option value="0">- Select -</option>                  
						<option value="1">Mostly Sitting</option>                  
						<option value="2">Occasionally Sitting</option>                
						<option value="3">Mostly Walking</option>                
						<option value="4">Mostly Hard Physical Work</option>              
         	        		</select>         
    		    </div>  

		    <div id="btn-calculate-dpa-classic" data-role="button">Calculate Classic DPA</div>
	        </div> 
		
	        <div data-role="controlgroup" data-type="horizontal" id="page3-points-allowance-settings-buttons">
				<a href="#" data-role="button" data-theme="b" class="prev" style="width: 125px; margin:0 10px 0px 0px;">Previous</a>
				<a href="#" data-role="button" data-theme="e" class="next" style="width: 100px; margin:0 10px 0px 0px;">Next</a>
	        </div>
	    </div> <!-- /Points Allowance Settings -->
		
	    <!-- Activity Settings -->
		<div data-role="content" id="page4-actvity-settings">
			<div>                  
				<table cellpadding="0" cellspacing="0">					
					<col style="width:44px;" />					
					<col style="width:auto;" />					
					<tr>												
						<td>							
							<div>																 
								<a href="javascript:void(0)" id=""><img class="info_image" src="./img/information.jpg" /></a>							
							</div>                          
						</td>                                                     
						<td>                                                                                 
							<div class="mobile_label">                                       
								Accumulation Frequency                                    
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-accumulation-frequency" data-native-menu="false">                                          
									<option>- Select -</option>              
									<option value="0">Daily</option>             
									<option value="1">Weekly</option>  
								</select>                                  
							</div>  																   
						</td>	
					</tr>	
					<tr>												
						<td>							
							<div>																 
								<a href="javascript:void(0)" id=""><img class="info_image" src="./img/information.jpg" /></a>							
							</div>                          
						</td>                                                     
						<td>                                                                                 
							<div class="mobile_label">                                       
								Precision                                    
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-precision" data-native-menu="false">                                          
									<option>- Select -</option>             
									<option value="0">Round to nearest whole number</option>                
									<option value="1">Round to nearest half number</option>   
								</select>                                  
							</div>  																   
						</td>	
					</tr>	
					<tr>												
						<td>							
							<div>																 
								<a href="javascript:void(0)" id=""><img class="info_image" src="./img/information.jpg" /></a>							
							</div>                          
						</td>                                                     
						<td>                                                                                 
							<div class="mobile_label">                                       
								Calculate By                                    
							</div>                                                                  
							<div data-role="fieldcontain">                                       
								<select data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" id="select-calculate-by" data-native-menu="false">                                          
									<option>- Select -</option>               
									<option value="0">Activity Intensity</option>                
									<option value="1">Calories</option>   
								</select>                                  
							</div>  																   
						</td>	
					</tr>								                            
				</table>               
			</div>

			<div data-role="controlgroup" data-type="horizontal" id="page4-actvity-settings-buttons">
				<a href="#" data-role="button" data-theme="b" class="prev" style="width: 125px; margin:0 10px 0px 0px;">Previous</a>
			</div>
		</div>
	</div> 

	<script src="./js/jquery-1.11.0.min.js"></script>	
	<script src="./js/jquery.mobile-1.3.2.min.js"></script>  
	<script type="text/javascript" src="./js/zebra_dialog.js"></script>
	<script type="text/javascript" src="./js/zebra_datepicker.js"></script> 
	<script type="text/javascript" src="./js/wizard.js"></script>
	<script type="text/javascript" src="./js/help.js"></script>      
	<script type="text/javascript" src="./js/KeyFilters.js"></script>   
	<script type="text/javascript" src="./js/daily-points-allowance-calculator.js"></script> 
	<script src="./Plugins/jQuery Keypad 2.0.0/jquery.plugin.js"></script>   
	<script src="./Plugins/jQuery Keypad 2.0.0/jquery.keypad.js"></script>	
	<script src="./Plugins/Touch Friendly Input Spinner/bootstrap/js/bootstrap.min.js"></script>
	<script src="./Plugins/Touch Friendly Input Spinner/bootstrap-touchspin/bootstrap.touchspin.js"></script>
	<script>
		$("input[name='user-height-feet']").TouchSpin({ min: 1, max: 9 });
		$("input[name='user-height-inches']").TouchSpin({ min: 0, max: 11 });
	</script>
        <script src="./Plugins/JQuerySpinnerControl_1.0.2/jquery.spinnercontrol.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function () {
                //$("#txtDefault").SpinnerControl();
 	        $("#txt-height-ft").SpinnerControl({
                    type: 'range',
                    typedata: { min: 0, max: 9, interval: 1 },
                    defaultVal: 0,
                    width: '50px'
    	        }); 
                $("#txt-height-in").SpinnerControl({
                    type: 'range',
                    typedata: { min: -1, max: 11, interval: 1 },
                    defaultVal: -1,
                    width: '50px'
                }); 
            })
        </script>	
	<script> 
		$(function() 
		{
      			$("#btn-calculate-dpa-classic").click( function()
           		{
				if ($("#select-gender-classic").val() == 0 ||
				    $("#select-age-classic").val() == 0 ||
				    $("#txt-classic-weight").val() == '' ||
				    $("#select-height-classic").val() == 0 ||
				    $("#select-activity-level-classic").val() == 0 )
				{
					alert('Required fields not entered');
					return;
				}

				if ($("#txt-classic-weight").val().length < 2)
				{
					alert('Weight must be at least 2 digits.');
					return;
				}

				//alert('Passed validation');

				// Get selected gender
				var selectedGender = 0;
				var genderIndex = $("#select-gender-classic").find(":selected").val();	
						
				if (genderIndex == 1) 
				{
					selectedGender = GENDER_MALE;
				}
				else if (genderIndex == 2) 
				{					
					var isBreastfeeding = $("#ckBreastfeeding").prop("checked");

					if (isBreastfeeding) selectedGender = GENDER_FEMALE_BREASTFEEDING;
					else selectedGender = GENDER_FEMALE_NOT_BREASTFEEDING;
				}

				var selectedAge = $("#select-age-classic").find(":selected").val();
				var inputWeight = parseInt( $("#txt-classic-weight").val() );
				var selectedHeight = $("#select-height-classic").find(":selected").val(); 
				var selectedActivityLevel = $("#select-activity-level-classic").find(":selected").val();   

             			var dpa = CalculateClassicDPA(selectedGender, selectedAge, inputWeight, selectedHeight, selectedActivityLevel);
				$('#dpa-result').text('Your daily points allowance is ' + dpa);
           		});

			$("#btn-calculate-dpa-plus").click( function()
			{		
				var selected_gender = $("#select-gender-plus").find(":selected").val();	
				if (selected_gender == 0)
				{
					alert('Gender is required');
					return;
				}

				var age = $("#txt-plus-age").val();
				if (age == '')
				{
					alert('Age is required');
					return;
				}
				age = parseInt(age);

				var weight = $("#txt-plus-weight").val();
				if (weight == '')
				{
					alert('Weight is required');
					return;
				}
				//weight = parseInt(weight) * 0.45359237;
				weight = parseInt(weight);

				var feet = $("#txt-height-ft").val();
				if (feet == 0)
				{
					alert('Height feet is required');
					return;
				}
				feet = parseInt(feet);

				var inches = $("#txt-height-in").val();
				if (inches == -1)
				{
					alert('Height inches is required');
					return;
				}
				inches = parseInt(inches);

				var selected_breastfeeding_status = $("#select-breastfeeding-plus").val();
				if ( selected_gender == 2 &&  selected_breastfeeding_status == 0 )
				{
					alert('Breastfeeding status is required');
					return;
				}				

				var dpa = 0;
				var height = feet * 12 + inches;	
				//var height = (feet * 12 + inches) * 0.0254;			

				if (selected_gender == 1) dpa = CalculateWWPlusDailyTargetScoreForMale(age, weight, height);
				else if (selected_gender == 2) dpa = CalculateWWPlusDailyTargetScoreForFemale(age, weight, height, selected_breastfeeding_status);

				if (dpa != 0) $('#dpa-result').text('Your daily points allowance is ' + dpa);
				
			});
		});
	</script>
	<script type="text/javascript" src="./Plugins/Android-Style-Date-Picker-For-jQuery-Mobile-Mobi-Pick/external/xdate.js"></script> 
	<script type="text/javascript" src="./Plugins/Android-Style-Date-Picker-For-jQuery-Mobile-Mobi-Pick/external/xdate.i18n.js"></script> 
	<script type="text/javascript" src="./Plugins/Android-Style-Date-Picker-For-jQuery-Mobile-Mobi-Pick/js/mobipick.js"></script>
	<script type="text/javascript">
		$(document).on("pagecreate",function()
		{
			var picker = $( "#txtDP", this );    
			picker.mobipick( {intlStdDate: false} ); 
		});
	</script>
</body>
</html>	
